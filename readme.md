Это последнее задание раздела по работе с SQL в курсе по анализу данных, который я изучаю.
Ниже - текст поставленной задачи.

"Описание проекта

В заключительном проекте раздела по базам данных представлено особенное задание. Вы в прямом смысле почувствуете работу CRM аналитика данных. Итак, прежде чем мы приступим к заданию, давайте немного познакомимся с таким понятием как CRM и некоторыми его составляющими.   
CRM -  это часть маркетинговой политики компании, направленная на прямое взаимодействие с клиентом посредством различных каналов. Это могут быть электронные письма, СМС, push-уведомления и т.п. коммуникации, которые призваны побудить покупателя совершать больше покупок. То есть, это некий способ поднять продажи компании.

После каждой коммуникации бизнес хочет знать, какой эффект ему эта коммуникация принесла. Для определения эффекта существуют разные методики, но мы воспользуемся классической. 

Итак - классические доп. продажи. Представим, что у нас есть база для отправки коммуникаций на 1200 человек. 1000 человек мы отправил push-уведомления, а 200 людям не отправили ничего. Сделано это для того, чтобы мы могли понаблюдать за поведением двух отдельных выборок людей и оценить эффективность коммуникаций.  Мы отправили 1000 push-уведомлений, из которых 900 дошли успешно, а 100 потерялись по дороге (их учитывать не будем). Сейчас у нас есть 2 группы: 900 человек с коммуникацией и 200 без неё. Теперь нам необходимо за ними понаблюдать.

Введём такое понятие как время наблюдения. В рамках нашей CRM задачи мы будем называть его периодом снятия эффективности. В данный период нужно проанализировать поведение пользователей - посчитать количество уникальных пользователей в каждой группе и количество тех, кто в исследуемый период совершил целевое действие (покупку). 

Ниже приведён пример того, что Вам необходимо сделать:

Допустим, в целевой группе (именно так называется группа, которой отправлялась коммуникация) 500 человек из 900 совершили покупки на общую сумму 50 000 рублей. В свою очередь, в контрольной группе (группа без коммуникации) 90 человек из 200 совершили покупки на общую сумму 9 000 рублей.

ARPPU (Average Revenue Per Paying User) - это метрика, которая показывает среднюю прибыль от одного платящего пользователя за определенный период времени. В каждой группе она составляет 100 рублей (50000/500=100 и 9000/90=100), однако, отклик в целевой группе составил 55% (500/900 = 0.55), а в контрольной группе 45% (90/200 = 0.45).

Теперь возьмём разницу между этими долями и, рассчитав дельту отклика (55% - 45% = 10%), умножим её на общее количество людей, получивших коммуникацию в целевой группе (0,1*900 = 90). Получается, что с помощью коммуникации мы привлекли 90 человек. Умножим количество привлечённых клиентов на ARPPU и получим привлеченную выручку 90*100=9000. Таким образом, мы выяснили, что наши действия принесли компании 9 000 рублей дополнительной выручки.

Для этого задания я сгенерировал 5 таблиц: Final_proj. Давайте пройдёмся по ним.

**compaining** - информация о кампании
<img width="761" height="221" alt="image" src="https://github.com/user-attachments/assets/efe2a3fd-5b49-4fd2-a395-728c4b7a0024" />

**sendings**  - информация об отправках
<img width="762" height="251" alt="image" src="https://github.com/user-attachments/assets/fdb0912d-cd1d-4a54-9a60-eda8f0ee7581" />

**response** - информация о статусе отправленных сообщений
<img width="762" height="258" alt="image" src="https://github.com/user-attachments/assets/a1521f84-c6a8-48fd-921d-0c7ade6a3080" />

**sales** - информация о продажах 

<img width="759" height="183" alt="image" src="https://github.com/user-attachments/assets/921d0e1a-2727-45a3-a0fd-a0c39aafb97b" />

**Задание**

Согласно представленной выше методике, Вам нужно оценить, какая кампания принесла больше всего дополнительной выручки.

Для этого:

**Вариант 1:** полностью напишите SQL скрипт, который автоматически посчитает дополнительные продажи.

**Вариант 2:** напишите скрипт, который посчитает: 

->Отклик (количество людей, совершивших покупку в исследуемый период)

->Количество людей в группах (учитывайте, что некоторые коммуникации не были доставлены)

->Валовые продажи по группам. 

Подключитесь к базе через Python, выгрузите данные при помощи написанного скрипта и посчитайте дополнительную выручку по каждой группе в интерактивном блокноте."



В папке database хранятся описанные выше таблицы в формате csv
в папке var1 и var2 мои решения первого и второго вариантов соответственно.
